<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Galatics Rats - Visualise Space Science</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.0.0/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/plotly.js/2.12.1/plotly.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/5.1.0/intro.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intro.js/5.1.0/introjs.min.css">
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #34495e;
            --accent-color: #3498db;
            --text-color: #1789f3;
            --background-color: #1a1a2e;
        }

        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--background-color);
            color: var(--text-color);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        h1, h2, h3 {
            text-align: center;
            color: var(--accent-color);
        }

        .section {
            background-color: var(--secondary-color);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .grid-item {
            background-color: var(--primary-color);
            border-radius: 5px;
            padding: 15px;
            transition: transform 0.3s ease;
        }

        .grid-item:hover {
            transform: scale(1.05);
        }

        #timeline, #heatmap, #physiological-changes {
            width: 100%;
            height: 400px;
        }

        #model-container {
            width: 100%;
            height: 400px;
            background-color: var(--primary-color);
        }

        select, button {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            background-color: var(--primary-color);
            color: var(--text-color);
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        button {
            background-color: var(--accent-color);
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: #2980b9;
        }

        #experiment-selector {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        #experiment-selector select {
            width: 48%;
        }

        .comparison-container {
            display: flex;
            justify-content: space-between;
        }

        .comparison-chart {
            width: 48%;
            height: 300px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Galatics Rats - Visualise Space Science</h1>
        
        <div id="experiment-selector">
            <select id="experiment1" onchange="updateComparison()">
                <option value="RR-23">Rodent Research-23</option>
                <option value="RR-1">Rodent Research-1</option>
                <option value="RR-9">Rodent Research-9</option>
            </select>
            <select id="experiment2" onchange="updateComparison()">
                <option value="RR-23">Rodent Research-23</option>
                <option value="RR-1">Rodent Research-1</option>
                <option value="RR-9">Rodent Research-9</option>
            </select>
        </div>
        
        <div class="section" id="experiment-overview">
            <h2>Experiment Overview</h2>
            <div class="grid">
                <div class="grid-item" data-step="1" data-intro="This shows the number of subjects in each group of the experiment.">
                    <h3>Subjects per Group</h3>
                    <p id="subjects-info">Loading...</p>
                </div>
                <div class="grid-item" data-step="2" data-intro="This describes the treatment applied to each group.">
                    <h3>Treatment</h3>
                    <p id="treatment-info">Loading...</p>
                </div>
                <div class="grid-item" data-step="3" data-intro="These are the events that occurred before launching the experiment to space.">
                    <h3>Pre-Launch Events</h3>
                    <ul id="pre-launch-events">Loading...</ul>
                </div>
                <div class="grid-item" data-step="4" data-intro="These are the events that occurred after the experiment returned from space.">
                    <h3>Post-Return Events</h3>
                    <ul id="post-return-events">Loading...</ul>
                </div>
            </div>
        </div>
        
        <div class="section" data-step="5" data-intro="This timeline shows key events throughout the experiment.">
            <h2>Experiment Timeline</h2>
            <div id="timeline"></div>
        </div>
        
        <div class="section" data-step="6" data-intro="Here you can explore 3D models related to the experiment.">
            <h2>3D Model Explorer</h2>
            <select id="model-selector" onchange="load3DModel()">
                <option value="iss">International Space Station</option>
                <option value="habitat">Rodent Habitat</option>
                <option value="tissue">Mouse Tissue Samples</option>
            </select>
            <div id="model-container"></div>
        </div>
        
        <div class="section" data-step="7" data-intro="This heatmap shows gene expression data from the experiment.">
            <h2>Gene Expression Heatmap</h2>
            <div id="heatmap"></div>
        </div>
        
        <div class="section" data-step="8" data-intro="This 3D plot shows physiological changes over time.">
            <h2>Physiological Changes Over Time</h2>
            <div id="physiological-changes"></div>
        </div>
        
        <div class="section" data-step="9" data-intro="Here you can compare data between two experiments.">
            <h2>Experiment Comparison</h2>
            <div class="comparison-container">
                <div id="comparison-chart1" class="comparison-chart"></div>
                <div id="comparison-chart2" class="comparison-chart"></div>
            </div>
        </div>
    </div>

    <script>
        // Simulated database
        const experimentData = {
            'RR-23': {
                subjects: {space: 10, control: 10},
                treatment: {space: "Microgravity exposure", control: "Normal gravity conditions"},
                preLaunchEvents: ["Animal selection", "Health checks", "Habitat preparation"],
                postReturnEvents: ["Immediate tissue collection", "Physiological measurements", "Data analysis"],
                timeline: [
                    {date: new Date("2021-06-01"), event: "Experiment Preparation"},
                    {date: new Date("2021-07-01"), event: "Launch to ISS"},
                    {date: new Date("2021-08-01"), event: "Return to Earth"}
                ],
                geneExpression: [
                    [1, 2, 3, 4, 5],
                    [2, 4, 6, 8, 10],
                    [3, 6, 9, 12, 15]
                ],
                physiologicalChanges: {
                    time: [0, 7, 14, 21, 28],
                    boneDensity: [100, 95, 90, 85, 80],
                    muscleMass: [100, 97, 94, 91, 88]
                }
            },
            'RR-1': {
                subjects: {space: 8, control: 8},
                treatment: {space: "Microgravity exposure", control: "Normal gravity conditions"},
                preLaunchEvents: ["Animal selection", "Health checks", "Habitat preparation"],
                postReturnEvents: ["Tissue collection", "Data analysis"],
                timeline: [
                    {date: new Date("2014-09-01"), event: "Experiment Preparation"},
                    {date: new Date("2014-09-21"), event: "Launch to ISS"},
                    {date: new Date("2014-10-25"), event: "Return to Earth"}
                ],
                geneExpression: [
                    [1, 3, 5, 7, 9],
                    [2, 6, 10, 14, 18],
                    [3, 9, 15, 21, 27]
                ],
                physiologicalChanges: {
                    time: [0, 7, 14, 21, 28],
                    boneDensity: [100, 93, 86, 79, 72],
                    muscleMass: [100, 96, 92, 88, 84]
                }
            },
            'RR-9': {
                subjects: {space: 12, control: 12},
                treatment: {space: "Microgravity exposure", control: "Normal gravity conditions"},
                preLaunchEvents: ["Animal selection", "Health checks", "Habitat preparation"],
                postReturnEvents: ["Tissue collection", "Physiological measurements", "Data analysis"],
                timeline: [
                    {date: new Date("2017-02-01"), event: "Experiment Preparation"},
                    {date: new Date("2017-02-19"), event: "Launch to ISS"},
                    {date: new Date("2017-03-20"), event: "Return to Earth"}
                ],
                geneExpression: [
                    [1, 4, 7, 10, 13],
                    [2, 8, 14, 20, 26],
                    [3, 12, 21, 30, 39]
                ],
                physiologicalChanges: {
                    time: [0, 7, 14, 21, 28],
                    boneDensity: [100, 97, 94, 91, 88],
                    muscleMass: [100, 98, 96, 94, 92]
                }
            }
        };

        // Update experiment overview
        function updateExperimentOverview(experimentId) {
            const data = experimentData[experimentId];
            document.getElementById('subjects-info').innerHTML = `Space Group: ${data.subjects.space} mice<br>Ground Control: ${data.subjects.control} mice`;
            document.getElementById('treatment-info').innerHTML = `Space Group: ${data.treatment.space}<br>Ground Control: ${data.treatment.control}`;
            document.getElementById('pre-launch-events').innerHTML = data.preLaunchEvents.map(event => `<li>${event}</li>`).join('');
            document.getElementById('post-return-events').innerHTML = data.postReturnEvents.map(event => `<li>${event}</li>`).join('');
        }

        // Timeline Visualization
        function updateTimeline(experimentId) {
            const data = experimentData[experimentId].timeline;
            const margin = {top: 20, right: 20, bottom: 30, left: 50};
            const width = document.getElementById('timeline').clientWidth - margin.left - margin.right;
            const height = document.getElementById('timeline').clientHeight - margin.top - margin.bottom;

            d3.select("#timeline").select("svg").remove();

            const svg = d3.select("#timeline")
                .append("svg")
                .attr("width", width + margin.left + margin.right)
                .attr("height", height + margin.top + margin.bottom)
                .append("g")
                .attr("transform", `translate(${margin.left},${margin.top})`);

            const x = d3.scaleTime().range([0, width]);
            const y = d3.scaleLinear().range([height, 0]);

            x.domain(d3.extent(data, d => d.date));
            y.domain([0, data.length - 1]);

            svg.append("g")
                .attr("transform", `translate(0,${height})`)
                .call(d3.axisBottom(x));

            svg.selectAll("circle")
                .data(data)
                .enter()
                .append("circle")
                .attr("cx", d => x(d.date))
                .attr("cy", (d, i) => y(i))
                .attr("r", 5)
                .attr("fill", "#3498db");

            svg.selectAll("text")
                .data(data)
                .enter()
                .append("text")
                .attr("x", d => x(d.date))
                .attr("y", (d, i) => y(i) - 10)
                .text(d => d.event)
                .attr("text-anchor", "middle")
                .attr("font-size", "12px")
                .attr("fill", "#ecf0f1");
        }

        // 3D Model Viewer
        let scene, camera, renderer, model;
        function init3DViewer() {
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, document.getElementById('model-container').clientWidth / document.getElementById('model-container').clientHeight, 0.1, 1000);
            renderer = new THREE.WebGLRenderer();
            renderer.setSize(document.getElementById('model-container').clientWidth, document.getElementById('model-container').clientHeight);
            document.getElementById('model-container').appendChild(renderer.domElement);
            camera.position.z = 5;
        }

        function load3DModel() {
            const modelType = document.getElementById('model-selector').value;
            
            // Clear existing model
            if (model) scene.remove(model);
            
            // Create a placeholder model (in a real scenario, you would load actual 3D models)
            let geometry;
            switch(modelType) {
                case 'iss':
                    geometry = new THREE.BoxGeometry(2, 1, 1);
                    break;
                case 'habitat':
                    geometry = new THREE.CylinderGeometry(0.5, 0.5, 2, 32);
                    break;
                case 'tissue':
                    geometry = new THREE.SphereGeometry(1, 32, 32);
                    break;
            }
            const material = new THREE.MeshBasicMaterial({color: 0x00ff00, wireframe: true});
            model = new THREE.Mesh(geometry, material);
            scene.add(model);
            
            animate();
        }

        function animate() {
            requestAnimationFrame(animate);
            model.rotation.x += 0.01;
            model.rotation.y += 0.01;
            renderer.render(scene, camera);
        }

        // Gene Expression Heatmap
        function updateHeatmap(experimentId) {
            const data = experimentData[experimentId].geneExpression;
            const layout = {
                title: 'Gene Expression Heatmap',
                xaxis: {title: 'Genes'},
                yaxis: {title: 'Samples'}
            };
            Plotly.newPlot('heatmap', [{
                z: data,
                type: 'heatmap',
                colorscale: 'Viridis'
            }], layout);
        }

        // Physiological Changes 3D Plot
        function updatePhysiologicalChanges(experimentId) {
            const data = experimentData[experimentId].physiologicalChanges;
            const trace1 = {
                x: data.time, y: data.boneDensity, z: data.muscleMass,
                mode: 'lines+markers',
                marker: {size: 5},
                line: {color: 'blue', width: 1},
                type: 'scatter3d'
            };
            const layout = {
                title: 'Physiological Changes Over Time',
                scene: {
                    xaxis:{title: 'Time (days)'},
                    yaxis:{title: 'Bone Density (%)'},
                    zaxis:{title: 'Muscle Mass (%)'}
                }
            };
            Plotly.newPlot('physiological-changes', [trace1], layout);
        }

        // Experiment Comparison
        function updateComparison() {
            const exp1 = document.getElementById('experiment1').value;
            const exp2 = document.getElementById('experiment2').value;
            
            updateComparisonChart('comparison-chart1', exp1);
            updateComparisonChart('comparison-chart2', exp2);
        }

        function updateComparisonChart(chartId, experimentId) {
            const data = experimentData[experimentId].physiologicalChanges;
            const trace1 = {
                x: data.time,
                y: data.boneDensity,
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Bone Density'
            };
            const trace2 = {
                x: data.time,
                y: data.muscleMass,
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Muscle Mass'
            };
            const layout = {
                title: `${experimentId} Physiological Changes`,
                xaxis: {title: 'Time (days)'},
                yaxis: {title: 'Percentage'}
            };
            Plotly.newPlot(chartId, [trace1, trace2], layout);
        }

        // Initialize all components
        function initAll() {
            updateExperimentOverview('RR-23');
            updateTimeline('RR-23');
            init3DViewer();
            load3DModel();
            updateHeatmap('RR-23');
            updatePhysiologicalChanges('RR-23');
            updateComparison();
            
            // Initialize guided tour
            introJs().setOptions({
                steps: [
                    {
                        element: document.querySelector('#experiment-overview'),
                        intro: "Welcome to the Advanced Space Biology Experiment Visualizer! Let's start with an overview of the experiment."
                    },
                    {
                        element: document.querySelector('#timeline'),
                        intro: "This timeline shows key events throughout the experiment."
                    },
                    {
                        element: document.querySelector('#model-container'),
                        intro: "Here you can explore 3D models related to the experiment."
                    },
                    {
                        element: document.querySelector('#heatmap'),
                        intro: "This heatmap visualizes gene expression data from the experiment."
                    },
                    {
                        element: document.querySelector('#physiological-changes'),
                        intro: "This 3D plot shows how physiological characteristics changed over time."
                    },
                    {
                        element: document.querySelector('.comparison-container'),
                        intro: "Finally, you can compare data between two different experiments here."
                    }
                ]
            }).start();
        }

        window.onload = initAll;
    </script>
</body>

<footer>

 <div class="container">
 <span class="text-muted">Copyright ©Galatics Rats, 2024. All rights reserved.</span>
 </div>
 </footer>

</html>                     